<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gerar Atendimento Técnico</title>

<link rel="shortcut icon" href="https://blogger.googleusercontent.com/img/a/AVvXsEhOTG15yPLfQ0IHI5vSAC0MKMDHWgJDZynAPSvwVDIkVLiPX5A6Qf4blmZTxVxcXGB-_Op0nqPHkHJPIdyVdYKm_nOaL35Dw1pgHQ5yR6E33iFMhCrz5t2d7Ab4Rps1ky_5eduohZstcSCGSh_4Jk2TukKd1l24tkRtgeRWw-_DzZZ8UnRLHtiYF5x0bzR6" type="image/x-icon">

<style>
  body { font-family: Arial, sans-serif; background: #f5f5f5; margin:0; padding:0; }
  header, footer { position: fixed; left:0; right:0; background:#fff; text-align:center; z-index:1000; }
  header { top:0; border-bottom:2px solid #c3080f; padding:10px 0; }
  footer { bottom:0; border-top:2px solid #c3080f; color:#c3080f; font-weight:bold; padding:10px 0; }
  header img { display:block; margin:0 auto 5px; }
  h2 { color:#333333; font-weight:700; margin:0; }
  main { margin:160px auto 100px; max-width:1000px; padding:20px; }

  table {
    width:100%;
    background:#fff;
    border-radius:5px;
    box-shadow:0 0 10px rgba(195,8,15,0.25);
    border:1px solid #c3080f;
    padding:16px;
    border-collapse: separate;
    border-spacing: 10px;
  }
  td { vertical-align:top; width:50%; }
  label { display:block; font-weight:700; margin-top:15px; margin-bottom:10px; color:#333333; }
  input, select, textarea {
    width:95%;
    padding:8px;
    border:1px solid #c3080f;
    border-radius:5px;
    font-size:14px;
  }
  textarea { min-height:100px; resize:vertical; }
  .btn {
    background:#c3080f;
    color:#fff;
    border:none;
    border-radius:8px;
    padding:12px 24px;
    font-size:16px;
    cursor:pointer;
    display:block;
    margin:20px auto 0;
  }
  .btn:hover { opacity: 0.9; }
  .btn-secondary {
    background:#333333;
    color:#ffffff;
    border:none;
    border-radius:8px;
    padding:12px 24px;
    font-size:16px;
    cursor:pointer;
  }
  .controls { text-align:center; margin-top:12px; }

  #printSection { display:none; text-align:left; }
  #datetime { text-align:right; color:#333333; font-size:14px; margin-bottom:12px; }

  .dados {
    background:#ffffff;
    border:1px solid #c3080f;
    border-radius:5px;
    padding:18px;
    box-shadow:0 0 8px rgba(195,8,15,0.18);
  }
  .dados h3 { color:#c3080f; border-bottom:1px solid #c3080f; padding-bottom:6px; margin-top:0; }
  .campo { margin-bottom:10px; }
  .campo strong { color:#333333; display:inline-block; width:220px; }

  .botoes-impressao {
    display: flex;
    flex-direction: column; /* coloca um abaixo do outro */
    align-items: center;    /* centraliza na horizontal */
    gap: 10px;              /* espaçamento de 10px entre os botões */
    margin-top: 20px;
  }

  .botoes-impressao button:first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  .botoes-impressao button:last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  @media (max-width:768px){
    main { margin:140px 10px 100px; padding:10px; }
    table { display:block; padding:12px; }
    td { display:block; width:100%; }
    input, select, textarea { width:100%; }
    .campo strong { display:block; width:100%; margin-bottom:4px; }
    .btn { width:100%; }
    .botoes-impressao { flex-direction: column; }
  }

  @media print {
    body { background:#fff; }
    main{ margin:0; padding:0; }
    header, footer { display:none !important; }
    #printSection { display:block !important; }
    #btnImprimir, #btnNovo { display:none !important; }
    #printHeader { display:block !important; }
  }
</style>
</head>
<body>

<header>
  <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgywsdWKH6rlDURrDoENalBtkXnhxike5bP4lesilVl-vBhsPrYmIIDLESb8VpR1e6AcRyxgXcyW8snNH4tSyIaJmTizACfOeqQYUjoaXhPE0MmMlHigietjYjKFLpEx5lccR3l10Q5RBwQMNBG8ENz6rAsMubobIyLRZa5DOLpWFtkMEH0Bx8_2LPVZFmb/s16000/logotipo-med-plus2025-1.png" alt="Logo" width="200">
  <h2>GERAR ATENDIMENTO TÉCNICO</h2>
</header>

<main>
  <form id="atendimentoForm" onsubmit="return false;">
    <table>
      <tr>
        <td>
          <label>TÉCNICO:</label>
          <input id="tecnico" type="text">

          <label>CLIENTE:</label>
          <input id="cliente" type="text">

          <label>TIPO DO ATENDIMENTO:</label>
          <select id="tipo">
            <option>Selecione...</option>
            <option>Visita técnica</option>
            <option>Remoto</option>
            <option>Telefônico</option>
          </select>

          <label>DATA:</label>
          <input id="data" type="date">

          <label>PERÍODO:</label>
          <select id="periodo">
            <option>Selecione...</option>
            <option>Manhã</option>
            <option>Tarde</option>
            <option>Noite</option>
          </select>

          <label>HORA:</label>
          <input id="hora" type="time">
        </td>
        <td>
          <label>CNPJ:</label>
          <input id="cnpj" type="text" maxlength="18" placeholder="00.000.000/0000-00">

          <label>ENDEREÇO:</label>
          <input id="endereco" type="text">

          <label>SITUAÇÃO:</label>
          <select id="situacao">
            <option>Selecione...</option>
            <option>Em atendimento</option>
            <option>Finalizado</option>
          </select>

          <label>MODELO EQUIPAMENTO:</label>
          <input id="modelo" type="text">

          <label>STATUS:</label>
          <select id="status">
            <option>Selecione...</option>
            <option>Avulso</option>
            <option>Aluguel</option>
            <option>Contrato</option>
            <option>Desinstalação</option>
            <option>Garantia</option>
            <option>Instalação</option>
          </select>
        </td>
      </tr>

      <tr>
        <td colspan="2">
          <label>DESCRIÇÃO DA FALHA:</label>
          <textarea id="falha"></textarea>

          <label>AÇÃO TOMADA:</label>
          <textarea id="acao"></textarea>

          <label>NOME DO RESPONSÁVEL:</label>
          <input id="responsavel" type="text">

          <label>TELEFONE:</label>
          <input id="telefone" type="text" maxlength="15" placeholder="(00) 00000-0000">
        </td>
      </tr>
    </table>

    <div class="controls">
      <button id="btnGerar" class="btn" type="button">GERAR ATENDIMENTO</button>
    </div>
  </form>

  <!-- Seção de impressão -->
  <section id="printSection" aria-hidden="true">
    <div id="printHeader" style="text-align:center; margin-bottom:8px; display:block;">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgywsdWKH6rlDURrDoENalBtkXnhxike5bP4lesilVl-vBhsPrYmIIDLESb8VpR1e6AcRyxgXcyW8snNH4tSyIaJmTizACfOeqQYUjoaXhPE0MmMlHigietjYjKFLpEx5lccR3l10Q5RBwQMNBG8ENz6rAsMubobIyLRZa5DOLpWFtkMEH0Bx8_2LPVZFmb/s16000/logotipo-med-plus2025-1.png" width="200" alt="Logo">
    </div>

    <div id="datetime"></div>
    <div id="dadosGerados" class="dados"></div>

    <div class="botoes-impressao">
      <button id="btnImprimir" class="btn" onclick="window.print()">IMPRIMIR</button>
      <button id="btnNovo" class="btn-secondary" onclick="novoAtendimento()">NOVO ATENDIMENTO</button>
    </div>
  </section>
</main>

<footer>MEDPLUS+ © Todos os direitos reservados</footer>

<script>
function getVal(id){ const el = document.getElementById(id); return el ? el.value.trim() : ''; }

function formatarDataBR(dataISO){
  if(!dataISO) return '';
  const [ano, mes, dia] = dataISO.split('-');
  return `${dia}/${mes}/${ano}`;
}

function gerarAtendimento() {
  let ultimo = localStorage.getItem('ultimoID');
  let id = ultimo ? (parseInt(ultimo,10) + 1) : 1;
  localStorage.setItem('ultimoID', id);

  const dataHoraGeracao = new Date();
  const dataHoraFormatada = dataHoraGeracao.toLocaleString('pt-BR');

  const campos = {
    tecnico: getVal('tecnico'),
    cliente: getVal('cliente'),
    tipo: getVal('tipo'),
    data: getVal('data'),
    periodo: getVal('periodo'),
    hora: getVal('hora'),
    cnpj: getVal('cnpj'),
    endereco: getVal('endereco'),
    situacao: getVal('situacao'),
    modelo: getVal('modelo'),
    status: getVal('status'),
    falha: getVal('falha'),
    acao: getVal('acao'),
    responsavel: getVal('responsavel'),
    telefone: getVal('telefone')
  };

  const exib = {
    "Nº do Atendimento": id,
    "Data/Hora de Geração": dataHoraFormatada,
    "Técnico": campos.tecnico,
    "Cliente": campos.cliente,
    "Tipo do Atendimento": campos.tipo,
    "Data (agendada)": formatarDataBR(campos.data),
    "Período": campos.periodo,
    "Hora (agendada)": campos.hora,
    "CNPJ": campos.cnpj,
    "Endereço": campos.endereco,
    "Situação": campos.situacao,
    "Modelo do Equipamento": campos.modelo,
    "Status": campos.status,
    "Descrição da Falha": campos.falha,
    "Ação Tomada": campos.acao,
    "Nome do Responsável": campos.responsavel,
    "Telefone": campos.telefone
  };

  localStorage.setItem('atendimento_fields', JSON.stringify(campos));
  localStorage.setItem('atendimento_display', JSON.stringify(exib));

  const html = `
    <h3>Dados do Atendimento</h3>
    ${Object.entries(exib).map(([k,v]) => `
      <div class="campo"><strong>${k}:</strong> ${v || '-'}</div>
    `).join('')}
  `;
  document.getElementById('dadosGerados').innerHTML = html;

  document.getElementById('atendimentoForm').style.display = 'none';
  document.getElementById('printSection').style.display = 'block';
  atualizarDataHora();
}

/*function atualizarDataHora(){
  const dtEl = document.getElementById('datetime');
  if(!dtEl) return;
  const dt = new Date();
  const dias = ["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"];
  dtEl.innerText = `${dias[dt.getDay()]}, ${dt.toLocaleTimeString('pt-BR')}`;
  setTimeout(atualizarDataHora, 1000);
}*/

function novoAtendimento(){
  localStorage.removeItem('atendimento_fields');
  localStorage.removeItem('atendimento_display');
  document.getElementById('atendimentoForm').reset();
  document.getElementById('printSection').style.display = 'none';
  document.getElementById('atendimentoForm').style.display = 'block';
}

window.addEventListener('load', () => {
  document.getElementById('btnGerar').addEventListener('click', gerarAtendimento);
});
</script>

</body>
</html>
